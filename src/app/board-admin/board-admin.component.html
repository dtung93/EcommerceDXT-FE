<body>
  <div class="container">
    <div class="row">
      <h3  class="text-white component-title">Manage Users</h3>
    </div>
    <div class="row">
      <div class="col-md-3">
        <input type="text" class="form-control" placeholder="Search by username" [(ngModel)]="username">
      </div>
      <div class="col-md-6 pt-2">
        <button class="btn text-white" id='search' (click)="searchUsername()">Search</button>
      </div>
      <div class="col-md-3 mt-3">
        <button type="button" class="btn btn text-white" style="background-color:#2d80b8" data-bs-toggle="modal" data-bs-target="#exampleModal">
          Add A User
        </button>
      </div>
    </div>

    <div class="row">
     <div class="col-sm-2">
      <button *ngIf="this.currentUserRole=='ROLE_MASTER'" (click)="addUserPanel()">Add New User</button>
      <div *ngIf="showUserPanel">
        <table>
          <tr>
<td>Username</td>
<td><input type='text'></td>
          </tr>
<tr>
<td>Password</td>
<td><input type='password'></td>
</tr>
<tr>
<td>Email</td>
<td><input type='email'></td>
</tr>
<tr>
<td>Role</td>
<td>
  <select>
   <option *ngFor="let role of selectedRoles" [value]="role">{{role.tag}}</option>
  </select>
</td>
</tr>
<tr>
  <button (click)="addUser()">Add User</button>
</tr>
        </table>

<<<<<<< HEAD
      </div>
=======




<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add A New Account</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
         <input type="text">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>
>>>>>>> 04f7154 (admin-control-view-menu-color-header)
     </div>

    </div>
    <div class="row">
      <div class="col-sm-2">
        <table class="table table-sm">
          <tbody>
            <tr>
              <th scope="row">Total users:</th>
              <td>{{totalAccounts}}</td>
          </tbody>
        </table>
      </div>
    </div>
    <table  class="table table p-0.5">
      <thead class="text-white" style="background-color: #2d80b8;">
        <tr>
          <th>User Name</th>
          <th>Email</th>
          <th>Role</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody class="px-5">
        <tr
          [ngClass]="{'usernamerow':this.currentUsername===user.username||
          checkAdminRole(user.roles),
          'masterrow':checkMasterRole(user.roles),
          'moderatorrow':checkModeratorRole(user.roles)}"
          *ngFor="let user of users | paginate
                  : {
                      itemsPerPage: pageSize,
                      currentPage: page,
                      totalItems: count
                    }">
          <td>{{user.username}}</td>
          <td>{{user.email}}</td>
          <td>
            <div *ngFor="let a of user.roles"><span>{{a['name']}}</span></div>

          </td>
          <td>
            <div class="controlbuttons" >
            <button class="btn btn text-white" 
              style="background-color: #318dca" (click)="this.userModal(user.id)">View</button>&nbsp;
            <button class="btn btn text-white" *ngIf="user.editable"
              style="background-color: rgb(170, 22, 22);" data-bs-toggle="modal" data-bs-target="#deleteModal" (click)="getUserDetail(user.id)">Delete</button>
          </div>
            </td>
        </tr>
      </tbody>
    </table>
    <pagination-controls previousLabel="Prev" nextLabel="Next" [responsive]="true"
      (pageChange)="handlePageChange($event)" style="float:right;padding-top:27px"></pagination-controls>

      <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header text-white" style="background-color: #318dca">
              <h4 class="modal-title"  id="exampleModalLabel">Delete confirmation</h4>
              <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              Are you sure you want to delete this account: <strong> {{selectedUser.username}}</strong> that has <strong *ngFor="let role of selectedUser.roles">{{role['name']}}</strong>?
            . <strong class="text-danger">This is an irreversible action!</strong></div>
            <div class="modal-footer">
              <button id="control" type="button" class="btn text-white" style="background-color: #145580;">Yes</button>
              <button id='control'type="button" class="btn btn-outline-dark "  data-bs-dismiss="modal">Cancel</button>         
            </div>
          </div>
        </div>
      </div>
  </div>
  
  
  <div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':display}">
    <div class=" modal-dialog modal-dialog-centered modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header text-white" style="background-color:#3085bd">
          <h4 class="modal-title">Edit Information</h4>
          <button type="button" class="btn-close btn-close-white" (click)="onCloseHandled()"><span
              aria-hidden="true"></span></button>
        </div>
        <div class="modal-body bg-light">
          <table [style]="width">
            <td><input type='hidden' [(ngModel)]="selectedUser.id" value={{selectedUser.id}}></td>
            <tr>
              <td>Username:</td>
              <div style="font-weight: bold;font-size: 20px;">{{selectedUser.username}}</div>
            </tr>
            <tr>
            <tr>
              <td>Role:</td>
              <td>
                <select [(ngModel)]='roleSelected'(change)="addRole(roleSelected.id)">
                  <option [id]="role.id" *ngFor="let role of selectedRoles" [selected]="role.id==selectedUser.roles[0]?.id" [ngValue]="role">{{role.tag}}</option>
                </select>
                <label style="color:red" *ngIf="this.selectedUser.roles.length==0">Must have at least 1 role</label>
              </td>
            </tr>
            <tr>
              <td>Email:</td>
              <input type='text' [style]="width" [(ngModel)]="selectedUser.email" value={{selectedUser.email}}>
            </tr>
          </table>
        </div>
        <div class="modal-footer">
          <tr><button *ngIf="selectedUser.roles[0]?.id!==4&&selectedUser.roles[0]?.id!==3"  id="control" class='btn btn text-white' style="background-color: #3085bd;"
              (click)='updateUser()'>Update</button></tr>
          <button type="button"  id="control" class="btn btn-outline-secondary" (click)="onCloseHandled()">Cancel</button>
        </div>
      </div>

    </div>
  </div>

</body>